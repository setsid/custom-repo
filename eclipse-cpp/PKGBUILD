# Maintainer: Vadim Kuznetsov <rics@gmx.it>

pkgname=eclipse-cpp
pkgver=20150703
pkgrel=1
pkgdesc="Powerful C/C++ IDE"
arch=('x86_64')
options=('!strip')
url="http://www.eclipse.org/"
license=('EPL')
depends=('jre' 'swt')
conflicts=('eclipse-cdt')
provides=('eclipse-cdt')
source=("eclipse-cpp-mars-R-linux-gtk-x86_64.tar.gz")
md5sums=('dc8a40fa49392b3de3fa94470e61afdb')

package()
{
    cd "$srcdir"
    mkdir -p "$pkgdir"/opt/$pkgname
    mv eclipse/* "$pkgdir"/opt/$pkgname
    mkdir -p "$pkgdir"/usr/bin
    ln -s /opt/$pkgname/eclipse "$pkgdir"/usr/bin/eclipse-cpp
    # switch to GTK2
    tmp_config=$(mktemp)
    echo -en "--launcher.GTK_version\n2\n" > "$tmp_config"
    cat "$pkgdir"/opt/${pkgname}/eclipse.ini >> "$tmp_config"
    install -m 0644 -o root -g root "$tmp_config" "$pkgdir"/opt/${pkgname}/eclipse.ini
    rm "$tmp_config"
}
