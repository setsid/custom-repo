# Maintainer: Vadim Kuznetsov <rics@gmx.it>

pkgname=eclipse-cdt-vanilla
pkgver=20170704
pkgrel=1
pkgdesc="Powerful C/C++ IDE (CDT vanilla version)"
arch=('x86_64')
options=('!strip')
url="http://www.eclipse.org/"
license=('EPL')
depends=('jre' 'swt')
conflicts=('eclipse-cdt' 'eclipse-cpp')
provides=('eclipse-cdt' 'eclipse-cpp')
source=("http://mirror.tspu.ru/eclipse/technology/epp/downloads/release/oxygen/R/eclipse-cpp-oxygen-R-linux-gtk-x86_64.tar.gz")
md5sums=('9d4c5cf267bb8b240601e9e7f3a4d8c1')

package()
{
    cd "$srcdir"
    mkdir -p "$pkgdir"/opt/$pkgname
    mv eclipse/* "$pkgdir"/opt/$pkgname
    mkdir -p "$pkgdir"/usr/bin
    ln -s /opt/$pkgname/eclipse "$pkgdir"/usr/bin/eclipse-cpp
    # switch to GTK2
    tmp_config=$(mktemp)
    echo -en "--launcher.GTK_version\n2\n" > "$tmp_config"
    cat "$pkgdir"/opt/${pkgname}/eclipse.ini >> "$tmp_config"
    install -m 0644 -o root -g root "$tmp_config" "$pkgdir"/opt/${pkgname}/eclipse.ini
    rm "$tmp_config"
}
